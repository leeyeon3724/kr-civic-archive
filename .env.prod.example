# Compose runtime (production)
APP_ENV=production
DEBUG=0
PORT=8000
UVICORN_WORKERS=4
API_PUBLISH_BIND=0.0.0.0
API_PUBLISH_PORT=8000

# Database
POSTGRES_USER=app_user
POSTGRES_PASSWORD=CHANGE_THIS_DB_PASSWORD
POSTGRES_DB=civic_archive
DB_PUBLISH_BIND=127.0.0.1
DB_PUBLISH_PORT=5432
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT_SECONDS=30
DB_POOL_RECYCLE_SECONDS=3600
DB_CONNECT_TIMEOUT_SECONDS=3
DB_STATEMENT_TIMEOUT_MS=5000

# Redis
REDIS_URL=redis://redis:6379/0
REDIS_APPENDONLY=yes
REDIS_PUBLISH_BIND=127.0.0.1
REDIS_PUBLISH_PORT=6379

# Security (strict mode)
SECURITY_STRICT_MODE=1
REQUIRE_API_KEY=1
API_KEY=CHANGE_THIS_API_KEY
REQUIRE_JWT=1
JWT_SECRET=CHANGE_THIS_MIN_32_BYTES_SECRET
JWT_ALGORITHM=HS256
JWT_LEEWAY_SECONDS=0
JWT_AUDIENCE=
JWT_ISSUER=
JWT_SCOPE_READ=archive:read
JWT_SCOPE_WRITE=archive:write
JWT_SCOPE_DELETE=archive:delete
JWT_ADMIN_ROLE=admin

# CORS/Host
ALLOWED_HOSTS=api.example.com
CORS_ALLOW_ORIGINS=https://app.example.com
CORS_ALLOW_METHODS=GET,POST,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Authorization,Content-Type,X-API-Key
TRUSTED_PROXY_CIDRS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# Rate limit / cache
READ_CACHE_TTL_SECONDS=0
RATE_LIMIT_PER_MINUTE=120
RATE_LIMIT_BACKEND=redis
RATE_LIMIT_REDIS_PREFIX=civic_archive:rate_limit
RATE_LIMIT_REDIS_WINDOW_SECONDS=65
RATE_LIMIT_REDIS_FAILURE_COOLDOWN_SECONDS=10
RATE_LIMIT_FAIL_OPEN=0

# Request guardrails
INGEST_MAX_BATCH_ITEMS=200
MAX_REQUEST_BODY_BYTES=1048576

# Logging
LOG_LEVEL=INFO
LOG_JSON=1
